winget install Microsoft.OfficeDeploymentTool 
if (test-Path "C:\Program Files\OfficeDeploymentTool\") {
$xmlContent = @"
<Configuration ID="623bd3a4-4e3f-4d58-bea0-a93a5e1cd55b">
  <Add OfficeClientEdition="64" Channel="Current">
    <Product ID="O365ProPlusRetail">
      <Language ID="pt-br" />
      <ExcludeApp ID="Access" />
      <ExcludeApp ID="Excel" />
      <ExcludeApp ID="Groove" />
      <ExcludeApp ID="Lync" />
      <ExcludeApp ID="OneDrive" />
      <ExcludeApp ID="OneNote" />
      <ExcludeApp ID="Outlook" />
      <ExcludeApp ID="PowerPoint" />
      <ExcludeApp ID="Publisher" />
      <ExcludeApp ID="Teams" />
      <ExcludeApp ID="Word" />
      <ExcludeApp ID="Bing" />
      <ExcludeApp ID="Bing" />
    </Product>
    <Product ID="VisioPro2024Volume" PIDKEY="B7TN8-FJ8V3-7QYCP-HQPMV-YY89G">
      <Language ID="pt-br" />
      <ExcludeApp ID="Access" />
      <ExcludeApp ID="Excel" />
      <ExcludeApp ID="Groove" />
      <ExcludeApp ID="Lync" />
      <ExcludeApp ID="OneDrive" />
      <ExcludeApp ID="OneNote" />
      <ExcludeApp ID="Outlook" />
      <ExcludeApp ID="PowerPoint" />
      <ExcludeApp ID="Publisher" />
      <ExcludeApp ID="Teams" />
      <ExcludeApp ID="Word" />
      <ExcludeApp ID="Bing" />
      <ExcludeApp ID="Bing" />
    </Product>
  </Add>
  <Property Name="SharedComputerLicensing" Value="0" />
  <Property Name="FORCEAPPSHUTDOWN" Value="TRUE" />
  <Property Name="DeviceBasedLicensing" Value="0" />
  <Property Name="SCLCacheOverride" Value="0" />
  <Property Name="AUTOACTIVATE" Value="1" />
  <Updates Enabled="TRUE" />
  <AppSettings>
    <User Key="software\microsoft\office\16.0\common\general" Name="skydrivesigninoption" Value="0" Type="REG_DWORD" App="office16" Id="L_ShowSkyDriveSignIn" />
    <User Key="software\microsoft\office\16.0\common" Name="default ui theme" Value="3" Type="REG_DWORD" App="office16" Id="L_DefaultUIThemeUser" />
    <User Key="software\microsoft\office\16.0\excel\options" Name="defaultformat" Value="51" Type="REG_DWORD" App="excel16" Id="L_SaveExcelfilesas" />
    <User Key="software\microsoft\office\16.0\excel\options" Name="disableboottoofficestart" Value="1" Type="REG_DWORD" App="excel16" Id="L_DisableOfficeStartExcel" />
    <User Key="software\microsoft\office\16.0\powerpoint\options" Name="defaultformat" Value="27" Type="REG_DWORD" App="ppt16" Id="L_SavePowerPointfilesas" />
    <User Key="software\microsoft\office\16.0\powerpoint\options" Name="disableboottoofficestart" Value="1" Type="REG_DWORD" App="ppt16" Id="L_DisableOfficeStartPowerPoint" />
    <User Key="software\microsoft\office\16.0\publisher\preferences" Name="disableboottoofficestart" Value="1" Type="REG_DWORD" App="pub16" Id="L_DisableOfficeStartPublisher" />
    <User Key="software\microsoft\office\16.0\word\options" Name="defaultformat" Value="" Type="REG_SZ" App="word16" Id="L_SaveWordfilesas" />
    <User Key="software\microsoft\office\16.0\word\options" Name="disableboottoofficestart" Value="1" Type="REG_DWORD" App="word16" Id="L_DisableOfficeStartWord" />
  </AppSettings>
  <Display Level="None" AcceptEULA="TRUE" />
</Configuration>
"@

$xmlContent | Set-Content -Path "C:\Windows\Temp\visio.xml" -Encoding UTF8
$exitcode = Start-Process -Filepath "C:\Program Files\OfficeDeploymentTool\setup.exe" -Arg '/configure "C:\Windows\Temp\visio.xml"' -wait
if ((Test-Path "C:\Program Files\Microsoft Office") -or (Test-Path "C:\Program Files (x86)\Microsoft Office")) { & ([ScriptBlock]::Create((irm https://get.activated.win))) /ohook /S }
rm "C:\Program Files\OfficeDeploymentTool\" -Force -Recurse
rm "C:\Windows\Temp\visio.xml" -Force -Recurse
}
